@page "/coaches/create"
@using HorsesForCourses.Application.dtos
@using HorsesForCourses.BlazorWasm.DTOs
@inject HttpClient Http
@inject NavigationManager NavigationManager

<PageTitle>New Coach</PageTitle>

<h3>Register New Coach</h3>
<hr />

<div class="row">
    <div class="col-md-4">
        <EditForm Model="@createCoachDto" OnValidSubmit="HandleValidSubmit">
            <DataAnnotationsValidator />
            <ValidationSummary />

            <div class="form-group mb-3">
                <label for="name" class="control-label">Full name</label>
                <InputText id="name" @bind-Value="createCoachDto.Name" class="form-control" />
            </div>
            <div class="form-group mb-3">
                <label for="email" class="control-label">E-mail</label>
                <InputText id="email" @bind-Value="createCoachDto.Email" class="form-control" />
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-primary">Save</button>
                <a href="/coaches" class="btn btn-secondary">Cancel</a>
            </div>
        </EditForm>
    </div>
</div>

@code {
    private CreateCoachDTO createCoachDto = new();

    private async Task HandleValidSubmit()
    {
        var response = await Http.PostAsJsonAsync("coaches/create", createCoachDto);

        if (response.IsSuccessStatusCode)
        {
            // Optionally show a success message using TempData-like service
            NavigationManager.NavigateTo("/coaches");
        }
        else
        {
            // Handle error (e.g., display a message)
        }
    }
}